define host {
	use generic-host
	check_command check-host-alive
	max_check_attempts 5
	notification_interval 30
	host_name {{ host.name }}
	alias {{ host.name }}
	address {{ host.fqdn }}
}

{# Base checks for all hosts #}
{% if 'base' in host.puppet_classes %}
define service{
	use generic-service
	host_name {{ host.name }}
	service_description Disk Space
	check_command check_nrpe!check_disk_5_2
}

define service{
	use generic-service
	host_name {{ host.name }}
	service_description Current Load
	check_command check_nrpe!check_load
}

define service{
	use generic-service
	host_name {{ host.name }}
	service_description Free ram
	check_command check_nrpe!check_ram
}

define service{
	use generic-service
	host_name {{ host.name }}
	service_description Puppet reshness
	check_command puppet-FAIL
}

define service{
	use generic-service
	host_name {{ host.name }}
	service_description SSH
	check_command check_ssh
}

define service{
	use generic-service
	host_name {{ host.name }}
	service_description Total processes
	check_command check_nrpe!check_processes
}

define service{
	use generic-service
	host_name {{ host.name }}
	service_description dpkg-check
	check_command check_nrpe!check_dpkg
}
{% endif %}

{# These trigger constantly on bastion hosts so skip those #}
{% host.puppet_vars.instanceproject != 'bastion' %}
define service{
	use generic-service
	host_name {{ host.name }}
	service_description Current Users
	check_command check_nrpe!check_users
}
{% endif %}